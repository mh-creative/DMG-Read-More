(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,o=window.wp.blocks,r=window.wp.blockEditor,n=window.wp.components,s=window.wp.element,l=window.wp.apiFetch;var a=e.n(l);(0,o.registerBlockType)("dmg/read-more",{title:"Read More Link",icon:"admin-links",category:"common",attributes:{postId:{type:"number"},postTitle:{type:"string"},postUrl:{type:"string"}},edit:function(e){const{attributes:o,setAttributes:l}=e,[i,p]=(0,s.useState)([]),[d,c]=(0,s.useState)(""),[m,u]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{a()({path:`/wp/v2/posts?search=${d}&per_page=100`}).then((e=>{if(p(e),!m&&o.postId){const t=e.find((e=>e.id===o.postId));t&&l({postTitle:t.title.rendered,postUrl:t.link}),u(!0)}}))}),[d,m]),(0,s.useEffect)((()=>{d||a()({path:"/wp/v2/posts?per_page=100"}).then((e=>{if(p(e),!o.postId&&e.length>0){const t=e[0];l({postId:t.id,postTitle:t.title.rendered,postUrl:t.link})}}))}),[]),(0,s.useEffect)((()=>{i.length>0&&o.postId&&!i.find((e=>e.id===o.postId))&&l({postId:i[0].id,postTitle:i[0].title.rendered,postUrl:i[0].link})}),[i]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(r.InspectorControls,null,(0,t.createElement)(n.PanelBody,{title:"Select a Post"},(0,t.createElement)(n.TextControl,{label:"Search Posts",value:d,onChange:e=>c(e)}),(0,t.createElement)(n.SelectControl,{label:"Select a Post",value:o.postId||"",options:i.map((e=>({label:e.title.rendered,value:e.id}))),onChange:e=>(e=>{const t=parseInt(e,10);if(!isNaN(t)){const e=i.find((e=>e.id===t));e&&l({postId:e.id,postTitle:e.title.rendered,postUrl:e.link})}})(e)}))),o.postId&&o.postTitle&&o.postUrl?(0,t.createElement)("p",{className:"dmg-read-more"},"Read More: ",(0,t.createElement)("a",{href:o.postUrl},o.postTitle)):(0,t.createElement)("p",{className:"dmg-read-more"},"Select a post to display the link."))},save:function(e){const{attributes:o}=e;return(0,t.createElement)("p",{className:"dmg-read-more"},"Read More: ",(0,t.createElement)("a",{href:o.postUrl},o.postTitle))}})})();